"use strict";(self.webpackChunkhans_renolution=self.webpackChunkhans_renolution||[]).push([[8933],{4137:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>m});var r=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var i=r.createContext({}),s=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=s(e.components);return r.createElement(i.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},k=r.forwardRef((function(e,n){var t=e.components,l=e.mdxType,a=e.originalType,i=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),u=s(t),k=l,m=u["".concat(i,".").concat(k)]||u[k]||d[k]||a;return t?r.createElement(m,o(o({ref:n},c),{},{components:t})):r.createElement(m,o({ref:n},c))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var a=t.length,o=new Array(a);o[0]=k;var p={};for(var i in n)hasOwnProperty.call(n,i)&&(p[i]=n[i]);p.originalType=e,p[u]="string"==typeof e?e:l,o[1]=p;for(var s=2;s<a;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}k.displayName="MDXCreateElement"},9981:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>p,toc:()=>s});var r=t(7462),l=(t(7294),t(4137));const a={},o="\u5bb9\u5668\u5316\u6280\u8853\u6982\u5ff5\u4ecb\u7d39\u8207\u5be6\u4f5c",p={unversionedId:"docker/Session",id:"docker/Session",title:"\u5bb9\u5668\u5316\u6280\u8853\u6982\u5ff5\u4ecb\u7d39\u8207\u5be6\u4f5c",description:"\u5bb9\u5668\u662f\u4ec0\u9ebc\uff1f",source:"@site/docs/docker/Session.md",sourceDirName:"docker",slug:"/docker/Session",permalink:"/docs/docker/Session",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Translate your site",permalink:"/docs/docusaurus/\u5b98\u65b9GetStarted/tutorial-extras/translate-your-site"},next:{title:"preview",permalink:"/docs/docker/preview"}},i={},s=[{value:"\u5bb9\u5668\u662f\u4ec0\u9ebc\uff1f",id:"\u5bb9\u5668\u662f\u4ec0\u9ebc",level:4},{value:"\u5fae\u670d\u52d9",id:"\u5fae\u670d\u52d9",level:4},{value:"docker",id:"docker",level:4},{value:"\u8edf\u9ad4\u90e8\u7f72",id:"\u8edf\u9ad4\u90e8\u7f72",level:4},{value:"\u4e3b\u5f9e\u5f0f\u67b6\u69cb",id:"\u4e3b\u5f9e\u5f0f\u67b6\u69cb",level:4},{value:"\u6a94\u6848",id:"\u6a94\u6848",level:4},{value:"\u53cd\u5411\u4ee3\u7406",id:"\u53cd\u5411\u4ee3\u7406",level:4},{value:"\u7db2\u8def\u74b0\u5883",id:"\u7db2\u8def\u74b0\u5883",level:4},{value:"docler cp",id:"docler-cp",level:4},{value:"docker create",id:"docker-create",level:4},{value:"docker \u540c\u7db2\u6bb5",id:"docker-\u540c\u7db2\u6bb5",level:4},{value:"muti stage build",id:"muti-stage-build",level:4},{value:"\u7f6e\u63db appsetting json \u5167\u5bb9",id:"\u7f6e\u63db-appsetting-json-\u5167\u5bb9",level:4},{value:"\u5728 Dockerfile \u8a2d\u5b9a\u9023\u7dda\u5b57\u4e32",id:"\u5728-dockerfile-\u8a2d\u5b9a\u9023\u7dda\u5b57\u4e32",level:4},{value:"\u70ba\u4ec0\u9ebc\u4e0d\u8981\u7576VM\u7528",id:"\u70ba\u4ec0\u9ebc\u4e0d\u8981\u7576vm\u7528",level:4},{value:"\u5916\u5305\u5546\u958b\u767c\u6642",id:"\u5916\u5305\u5546\u958b\u767c\u6642",level:4},{value:"container \u57f7\u884c\u6642",id:"container-\u57f7\u884c\u6642",level:4},{value:"image",id:"image",level:4},{value:"docker scout",id:"docker-scout",level:4},{value:"Net 8 Live Demo",id:"net-8-live-demo",level:4},{value:"linkchecker",id:"linkchecker",level:4},{value:"Day 4",id:"day-4",level:3},{value:"CICD",id:"cicd",level:4},{value:"Tag \u7b56\u7565",id:"tag-\u7b56\u7565",level:4},{value:"\u8cc7\u6599\u6301\u4e45\u5316",id:"\u8cc7\u6599\u6301\u4e45\u5316",level:4},{value:"\u53ef\u7528\u6027",id:"\u53ef\u7528\u6027",level:4},{value:"\u5065\u5eb7\u6aa2\u67e5",id:"\u5065\u5eb7\u6aa2\u67e5",level:4},{value:"container \u8a2d\u8a08\u539f\u5247",id:"container-\u8a2d\u8a08\u539f\u5247",level:4},{value:"day 5",id:"day-5",level:4},{value:"day 6",id:"day-6",level:4},{value:"day 6",id:"day-6-1",level:3},{value:"update conntainername",id:"update-conntainername",level:2}],c={toc:s};function u(e){let{components:n,...a}=e;return(0,l.kt)("wrapper",(0,r.Z)({},c,a,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"\u5bb9\u5668\u5316\u6280\u8853\u6982\u5ff5\u4ecb\u7d39\u8207\u5be6\u4f5c"},"\u5bb9\u5668\u5316\u6280\u8853\u6982\u5ff5\u4ecb\u7d39\u8207\u5be6\u4f5c"),(0,l.kt)("h4",{id:"\u5bb9\u5668\u662f\u4ec0\u9ebc"},"\u5bb9\u5668\u662f\u4ec0\u9ebc\uff1f"),(0,l.kt)("p",null,"vm \u786c\u9ad4\u8cc7\u6e90\u5229\u7528\u6700\u5927\u5316\n\u5bb9\u5668\u5316\uff1a \u7a0b\u5f0f\u5305\u6210 container image (\u5c31\u50cf\uff29\uff33\uff2f\u6a94\u6848)\n\u5305\u542b runtime, system setting, main program\nrun \u8d77\u4f86\u4e4b\u5f8c\u7684\u6a94\u6848\u5728\u5bb9\u5668\u522a\u6389\u4e4b\u5f8c\u90fd\u6703\u4e0d\u898b\uff0c\u4f8b\u5982: LogFile \u7522\u751f\u6a94\u6848\uff0c\u4e0a\u50b3\u6a94\u6848\u4e4b\u985e\u7684\u670d\u52d9\n\u66f4\u7248\u7684\u6642\u5019 image \u88e1\u9762\u7684\u6a94\u6848\u90fd\u6703\u4e0d\u898b\uff0csln-> \u8a2d\u5b9a\u5c0d\u61c9\u7684\u5be6\u9ad4\u786c\u789f\uff0c\u6a94\u6848\u5c31\u6703\u4e1f\u904e\u53bb\n\u4e3b\u7a0b\u5f0f\u7d50\u675f\uff0cdocker\u5c31\u7d50\u675f\uff0c\u5982\u679c\u88e1\u9762\u6709\u5176\u4ed6\u7a0b\u5f0f\u5728\u8dd1\uff0c\u4e0d\u6703\u77e5\u9053\n\u2018\u57f7\u884c\u4e2d\u7684 container \u53ef\u4ee5\u8f49\u6210 image\u2019\n\u5bb9\u5668\u6280\u8853 is \u8f15\u91cf\u865b\u64ec\u5316 \u4f5c\u696d\u7cfb\u7d71\n\u7121\u72c0\u614b \u6c38\u9060\u4e0d\u6703\u66f4\u65b0"),(0,l.kt)("h4",{id:"\u5fae\u670d\u52d9"},"\u5fae\u670d\u52d9"),(0,l.kt)("p",null,"\u5c07\u7cfb\u7d71\u5207\u5206\u6210\u5c0f\u9805\u76eecontainer image\uff0c\u5f7c\u6b64\u7528 API \u505a\u6e9d\u901a\n\u8907\u96dc\u6027\u8b8a\u9ad8 >> \u81ea\u52d5\u5316 > \u7121\u72c0\u614b\uff5e\n\u5982\u679c\u8981\u6709\u72c0\u614b\u7684\uff0c\u5c31\u7368\u7acb\u51fa\u4f86\u4e00\u500b Services \u7d66\u5927\u5bb6\u505a\u4f7f\u7528(\u4f8b\u5982 File Upload download)"),(0,l.kt)("h4",{id:"docker"},"docker"),(0,l.kt)("p",null,"--rm \u4e3b\u7a0b\u5f0f \u505c\u6389\u5c31\u522a\u9664\nattach \u52a0\u6a94\u6848\nexec \u57f7\u884c\u5bb9\u5668\u5167\u67d0\u4e00\u7a0b\u5f0f\n\u6307\u5b9a \u4e3b\u7a0b\u5f0f\n-d \u80cc\u666f\n-p 8080:80  \u672c\u6a5f 8080 \u5c0d\u61c9\u81f3 docker 80\n-e Default_connection=123 \u8a2d\u5b9a\u74b0\u5883\u8b8a\u6578\nlogs + id   \u770blog\nps -a",(0,l.kt)("br",{parentName:"p"}),"\n","-v \u639b\u8f09\u672c\u6a5f\u78c1\u789f -v G:\\Project:/Project\ncontrol-p  control-q \u9000\u51fa\u5bb9\u5668\u4e0d\u505c\u6b62\n--restart=always \u5bb9\u5668\u6c38\u9060\u57f7\u884c\n-P \u6240\u6709\u7684 port \u90fd\u639b\u4e0a\u53bb\n--privileged \u5c31\u6703\u6709\u7ba1\u7406\u54e1\u7684\u6b0a\u5229\uff0c\u6240\u4ee5\u4e0d\u8981\u96a8\u4fbf\u4e82\u7528"),(0,l.kt)("h4",{id:"\u8edf\u9ad4\u90e8\u7f72"},"\u8edf\u9ad4\u90e8\u7f72"),(0,l.kt)("p",null,"\u53ef\u52d5\u614b \u6539\u8b8a\u4e0d\u540c\u8a2d\u5b9a\u3001\u65b0\u589e\u529f\u80fd \u300a\u7d44\u614b\u98c4\u79fb\u300b\n\u5229\u7528\u5fae\u670d\u52d9\u67b6\u69cb\u4f86 \u2018\u5206\u985e\u2019\u53ca\u2018\u7ba1\u7406\u2019"),(0,l.kt)("h4",{id:"\u4e3b\u5f9e\u5f0f\u67b6\u69cb"},"\u4e3b\u5f9e\u5f0f\u67b6\u69cb"),(0,l.kt)("p",null,"client \u900f\u904e restapi \u547c\u53eb docker deamon (docker host)"),(0,l.kt)("p",null,"\u57f7\u884ccontainer \u88e1\u9762\u7684 bash\ndocker exec -it ContaineriID bash\n\u5b89\u88dd apt & cowsay\napt update && apt-get install cowsay -y\n\u57f7\u884c cowsay\ncowsay"),(0,l.kt)("h4",{id:"\u6a94\u6848"},"\u6a94\u6848"),(0,l.kt)("p",null," \u5169\u500bdocker \u5171\u7528\u6a94\u6848\u4f3a\u670d\u5668\ndocker \u53ea\u8b80\ndocker \u53ea\u5beb"),(0,l.kt)("h4",{id:"\u53cd\u5411\u4ee3\u7406"},"\u53cd\u5411\u4ee3\u7406"),(0,l.kt)("p",null,"ect > nginx > conf.d >  default.conf"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"location / {\n    proxy_pass https://www.skl.com.tw;\n    proxy_set_header Host www.skl.com.tw;  \n}\n")),(0,l.kt)("p",null,"\u5efa\u7acb nginx 80 \u5c0d\u61c9\u81f3\u672c\u6a5f 8080\ndocker run --name myng -it -d nginx:latest -p 8080:80"),(0,l.kt)("p",null,"\u91cd\u555f\u4f3a\u670d\u5668\ndocker exec -it containerid nginx -s reload"),(0,l.kt)("h4",{id:"\u7db2\u8def\u74b0\u5883"},"\u7db2\u8def\u74b0\u5883"),(0,l.kt)("p",null," ",(0,l.kt)("img",{alt:"docker \u67e5\u8a62\u7db2\u8def",src:t(716).Z,width:"1898",height:"502"}),"\nespanso"),(0,l.kt)("h4",{id:"docler-cp"},"docler cp"),(0,l.kt)("p",null,"docker cp /Users/hansjiang/Project/DockerSession/ /ubuntu:Temp\ndocker cp TEMP ubuntu:/TEMP\n/Users/hansjiang/Project/DockerSession/"),(0,l.kt)("h4",{id:"docker-create"},"docker create"),(0,l.kt)("p",null,"\u53ea\u5efa\u7acb\u5bb9\u5668\u4f46\u662f\u4e0d\u8dd1\u4ed6\n\u9084\u662f\u53ef\u4ee5 cp \u6a94\u6848\u51fa\u4f86"),(0,l.kt)("h4",{id:"docker-\u540c\u7db2\u6bb5"},"docker \u540c\u7db2\u6bb5"),(0,l.kt)("p",null," --network  n1  image "),(0,l.kt)("h4",{id:"muti-stage-build"},"muti stage build"),(0,l.kt)("h4",{id:"\u7f6e\u63db-appsetting-json-\u5167\u5bb9"},"\u7f6e\u63db appsetting json \u5167\u5bb9"),(0,l.kt)("p",null," docker -e Log__Loglevel=Trace "),(0,l.kt)("h4",{id:"\u5728-dockerfile-\u8a2d\u5b9a\u9023\u7dda\u5b57\u4e32"},"\u5728 Dockerfile \u8a2d\u5b9a\u9023\u7dda\u5b57\u4e32"),(0,l.kt)("p",null,"-e ENV = ConnectionString__ATT ITATTDB000"),(0,l.kt)("h4",{id:"\u70ba\u4ec0\u9ebc\u4e0d\u8981\u7576vm\u7528"},"\u70ba\u4ec0\u9ebc\u4e0d\u8981\u7576VM\u7528"),(0,l.kt)("p",null,"\u4e00\u53f0\uff36\uff2d\u53ef\u4ee5\u8dd1\u591a\uff21\uff30\n\u4e00\u500bcontainer \u8dd1\u591a\u500b\uff21\uff30\u6703\u628a\u554f\u984c\u8907\u96dc\u5316"),(0,l.kt)("h4",{id:"\u5916\u5305\u5546\u958b\u767c\u6642"},"\u5916\u5305\u5546\u958b\u767c\u6642"),(0,l.kt)("p",null,"\u50c5\u80fd\u4f7f\u7528\u6211\u5011\u8a31\u53ef\u7684image "),(0,l.kt)("h4",{id:""}),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5bb9\u5668\u9003\u9038\n\u5f9e\u5bb9\u5668\u8df3\u51fa\u4f86\u5c07\u75c5\u6bd2\u690d\u5165\u5be6\u9ad4\u4e3b\u6a5f\n\u9808\u5b9a\u671f\u66f4\u65b0\u5bb9\u5668\u5f15\u7434")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f9b\u61c9\u93c8\u6295\u6bd2")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f9b\u61c9\u93c8\u52ab\u6301\n\u964d\u4f4eimage layer \u5c64\u6578")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u60e1\u610f\u5bb9\u5668"))),(0,l.kt)("h4",{id:"container-\u57f7\u884c\u6642"},"container \u57f7\u884c\u6642"),(0,l.kt)("p",null,"\u8dd1\u8d77\u4f86\u6642\u6703\u662f\u6700\u5927\u6b0a\u9650 "),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://podman.io/features"},"https://podman.io/features"),"\npodman: reahat \u505a\u7684 docker"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://containerd.io/"},"https://containerd.io/"),"\ncontainerd K8s\u4f7f\u7528\u7684 runtime"),(0,l.kt)("h4",{id:"image"},"image"),(0,l.kt)("p",null,"docker run image\n\u4e00\u500b repository \u53ef\u4ee5\u6709\u5f88\u591a\u500b image\n\u4e00\u500b registry \u6709\u5f88\u591a\u500b repository\nimage id = image hash\u76f4\ntag \u9810\u8a2d\u70ba latest (\u6a19\u7c64 or \u7248\u865f)"),(0,l.kt)("p",null,"\u4e0d\u540c repository \u4e0d\u540c tag \u53ef\u4ee5\u6307\u5411\u540c\u4e00\u500bimage\n\u4e0d\u540c repository \u53ef\u6307\u5411\u540c\u4e00\u500b image id"),(0,l.kt)("p",null,"repository + tag \u5c31\u662f\u4e00\u500b\u5225\u540d\uff0c\u6700\u7d42\u6307\u50cf\u4e00\u500b image id"),(0,l.kt)("h4",{id:"docker-scout"},"docker scout"),(0,l.kt)("p",null,"docker scout enroll hansjiang1123\n\xe2\x9c\x93 Successfully enrolled organization <ORG_NAME> with Docker Scout Free"),(0,l.kt)("p",null,"docker scout repo enable --org hansjiang1123 hansjiang1123/scout-demo"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"docker buildx build --provenance=true --sbom=true --push -t hansjiang1123/scout-demo:v4 .\n\ndocker build --provenance= true --sbom true --push -t hansjiang1123/scout-demo:v3 .\n")),(0,l.kt)("h4",{id:"net-8-live-demo"},"Net 8 Live Demo"),(0,l.kt)("p",null,"\u8dd1 docker \u4e0d\u7528\u52fe\u9078 https"),(0,l.kt)("p",null,"\u56e0\u70ba\u8981\u5305\u524d\u7aef\uff0c\u6240\u4ee5\u8981 use staticFiles"),(0,l.kt)("p",null,"\u6211\u9700\u8981\u5efa\u7f6e\u4e00\u500b an v18 \u7684\u5c08\u6848\uff0c \u5e6b\u6211\u52a0\u5165\u4e00\u500b stage \u6b65\u9a5f\n\u6211\u8981\u7528 production build "),(0,l.kt)("p",null,"\u63d2\u5165 Dockerfile final \u524d\nxxx/. xxx\u76ee\u9304\u4e0b\u6240\u6709\u6a94\u6848"),(0,l.kt)("p",null,"\u6700\u5f8c\u5728 copy \u5230 wwwroot"),(0,l.kt)("p",null,"npm install module \u7a7a\u9593\u7ad9\u5f88\u5927\n\u8981\u6539 .dockerignore\nskl-froint/node-modules",(0,l.kt)("br",{parentName:"p"}),"\n","docker run -d --name -rm -p 8080:8080 "),(0,l.kt)("p",null,"docker exec -it  skl-docker ls -laF /app/publish/wwwwroot/browser\n\u78ba\u8a8d\u7db2\u9801\u6709call \u9032\u53bb"),(0,l.kt)("p",null,"app.use defalutfile()"),(0,l.kt)("p",null,"type XXX.bat | clap.exe\n\u8907\u88fd"),(0,l.kt)("h4",{id:"linkchecker"},"linkchecker"),(0,l.kt)("p",null,"\u9023\u7d50\u6aa2\u67e5"),(0,l.kt)("h3",{id:"day-4"},"Day 4"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://tinyurl.com/yc7s6fe6"},"https://tinyurl.com/yc7s6fe6"),"\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/srcmesh-workshop/docker-workshop"},"https://github.com/srcmesh-workshop/docker-workshop")),(0,l.kt)("p",null,"\u9023\u7dda\u65b9\u5f0f:"),(0,l.kt)("p",null,"Grafana: ",(0,l.kt)("a",{parentName:"p",href:"http://35.201.170.213:3000/"},"http://35.201.170.213:3000/"),"\nGraylog: ",(0,l.kt)("a",{parentName:"p",href:"http://35.201.170.213:9000/"},"http://35.201.170.213:9000/")),(0,l.kt)("p",null,"\u5e33\u5bc6: admin / srcmesh-1234\nuser-1\nsrcmesh-123456789"),(0,l.kt)("h4",{id:"cicd"},"CICD"),(0,l.kt)("p",null,"image build once use any where\ndev QA Op \u90fd\u7528\u540c\u4e00\u4efd"),(0,l.kt)("h4",{id:"tag-\u7b56\u7565"},"Tag \u7b56\u7565"),(0,l.kt)("p",null,"\u5982\u679c\u4e00\u6708\u7684 image \u907a\u5931\uff0c\u518d\u6b21\u5305\u7684 image tag \u503c\u4e0d\u53ef\u4ee5\u4e00\u6a23\uff0c\u56e0\u70ba\u4f9b\u61c9\u5546 package \u7248\u672c\u53ef\u80fd\u6703\u66f4\u65b0\n1/1\nfoobar commmit timestampe\n6/1\nfoobar commmit timestampe"),(0,l.kt)("h4",{id:"\u8cc7\u6599\u6301\u4e45\u5316"},"\u8cc7\u6599\u6301\u4e45\u5316"),(0,l.kt)("p",null,"Bind Mounts\n$pwd \u73fe\u5728\u5728\u54ea\u88e1"),(0,l.kt)("h4",{id:"\u53ef\u7528\u6027"},"\u53ef\u7528\u6027"),(0,l.kt)("p",null,"F5>\n\u591a\u53f0 host>\nnginx \u53cd\u5411\u4ee3\u7406>\ndocker "),(0,l.kt)("h4",{id:"\u5065\u5eb7\u6aa2\u67e5"},"\u5065\u5eb7\u6aa2\u67e5"),(0,l.kt)("p",null,"\u6aa2\u67e5\u5340\u9593 interval: 5 \u79d2\u9418\n\u8d85\u6642\u6642\u9593 timeout: \u4f9d\u64da\u9ad8\u4f4e\u5cf0\u5e73\u5747\u503c\u53bb\u8a2d\u5b9a\n\u91cd\u8a66\u6b21\u6578 3~5 \u6b21\n\u6709\u6c92\u6709\u6d3b\u8457 \u8ddf \u53ef\u4e0d\u53ef\u4ee5\u670d\u52d9\u3001\u63a5\u53d7\u65b0\u7684\u6d41\u91cf accept request"),(0,l.kt)("p",null,"cron \u6392\u6210\u8173\u672c \u5b9a\u6642\u505a docker restart\nsrcmesh-123456789"),(0,l.kt)("h4",{id:"container-\u8a2d\u8a08\u539f\u5247"},"container \u8a2d\u8a08\u539f\u5247"),(0,l.kt)("p",null,'"',(0,l.kt)("a",{parentName:"p",href:"https://github.com/srcmesh-workshop/docker-workshop"},"https://github.com/srcmesh-workshop/docker-workshop")),(0,l.kt)("p",null,"\u9023\u7dda\u65b9\u5f0f:"),(0,l.kt)("p",null,"Grafana: ",(0,l.kt)("a",{parentName:"p",href:"http://35.201.170.213:3000/"},"http://35.201.170.213:3000/"),"\nGraylog: ",(0,l.kt)("a",{parentName:"p",href:"http://35.201.170.213:9000/"},"http://35.201.170.213:9000/")),(0,l.kt)("p",null,'\u5e33\u5bc6: admin / srcmesh-1234\n"\t\t\t\t\t'),(0,l.kt)("p",null,'"',(0,l.kt)("a",{parentName:"p",href:"https://github.com/srcmesh-workshop/docker-workshop"},"https://github.com/srcmesh-workshop/docker-workshop")),(0,l.kt)("p",null,"Grafana: ",(0,l.kt)("a",{parentName:"p",href:"http://35.201.170.213:3000/"},"http://35.201.170.213:3000/"),"\nGraylog: ",(0,l.kt)("a",{parentName:"p",href:"http://35.201.170.213:9000/"},"http://35.201.170.213:9000/")),(0,l.kt)("p",null,'\u5e33\u5bc6: admin / srcmesh-1234\n"\t\t\t\t\t'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"                user-1 \n                srcmesh-123456789\n                \n                \n                \n                \n                \n                \n")),(0,l.kt)("p",null,"docker container run "),(0,l.kt)("p",null,'docker container run -dit \\\n--name user-01 \\\n-v $(pwd):/usr/share/nginx/html \\\n-p 10001:80 nginx:alpine \\\n--health-cmd "curl -f http://localhost:80/ || exit 1" \\\n--health-start-period=10s \\\n--health-interval=5s \\\n--health-retries=2 \\'),(0,l.kt)("p",null,"curl http://localhost:10001/"),(0,l.kt)("p",null,"srcmesh-123456789\n\u4f60\u73fe\u5728\u662f\u4e00\u500bNet Core MVC \u5c08\u5bb6\uff0cController\u6709\u4e00\u500bAction\u8ca0\u8cac\u5c07\u4f7f\u7528\u8005\u7684\u6a94\u6848\u50b3\u9001\u81f3\u5916\u90e8\u4e00\u652f\u5f71\u50cf\u8fa8\u8b58API\uff0cAPI\u7d93\u904e\u8655\u7406\u5f8c\u5c07\u6a94\u6848\u5167\u5bb9\u56de\u8986\u7d66\u4f7f\u7528\u8005\uff0c\n\u4e00\u500b\u6a94\u6848\u5167\u5bb9\u53ef\u80fd\u6703\u6709\u591a\u7b46\u8cc7\u6599\u56de\u8986\uff0c\u76ee\u524d\u9762\u81e8\u4e00\u500b\u6311\u6230\uff0c\u9019\u652f\u5f71\u50cf\u8fa8\u8b58API\u55ae\u6b21\u8655\u7406\u6642\u9593\u70ba\u4e94\u5206\u9418\uff0c\u5728View\u8207\u4f7f\u7528\u8005\u4e92\u52d5\u6642\uff0c\u4f7f\u7528\u8005\u4e00\u6b21\u4e0a\u50b320\u500b\u6a94\u6848\u7684\u60c5\u6cc1\u6642\uff0c\u975e\u5e38\u8017\u6642\uff0c\n\u5982\u4f55\u78ba\u4fdd\u7db2\u9801\u670d\u52d9\u6b63\u78ba\u4e14\u4e0d\u5f71\u97ff\u4f7f\u7528\u8005\u5728\u524d\u7aef\u7684\u4f7f\u7528\uff0c\u4e26\u5373\u6642\u5c07\u5f71\u50cf\u8fa8\u8b58API\u8655\u7406\u7d50\u679c\uff0c\u56de\u8986\u7d66\u4f7f\u7528\u8005\uff1f \u8acb\u63d0\u4f9b\u5be6\u969b\u7a0b\u5f0f\u78bc"),(0,l.kt)("h4",{id:"day-5"},"day 5"),(0,l.kt)("p",null,"\u9810\u8a2d\u7684\u4e00\u500b CPU \u9031\u671f\u70ba 100ms\n\u2022 --cpus=0.25 \u5373\u70ba 100ms * 0.25 = 25ms \u2192 \u9019\u500b\u5bb9\u5668\u5728\u6bcf\u500b CPU \u6642\u9593\u9031\u671f\u5167\u6700\u591a\u53ef\u4f7f\u7528\n25ms (\u5373 CPU \u4f7f\u7528\u7387\u70ba 25%)"),(0,l.kt)("p",null,"\u591a\u968e\u6bb5\u5efa\u69cb\uff0c\u53ef\u7626\u8eab image "),(0,l.kt)("p",null,"\u8a9e\u610f\u5316\u7248\u672c\n",(0,l.kt)("a",{parentName:"p",href:"https://semver.org/lang/zh-TW/"},"https://semver.org/lang/zh-TW/")),(0,l.kt)("p",null,"hans on lab"),(0,l.kt)("p",null,"DockerComposeTest\nHansJiang\nOcrHH23bD9EzDjcRhR"),(0,l.kt)("h4",{id:"day-6"},"day 6"),(0,l.kt)("p",null,'"',(0,l.kt)("a",{parentName:"p",href:"https://github.com/srcmesh-workshop/docker-workshop"},"https://github.com/srcmesh-workshop/docker-workshop")),(0,l.kt)("p",null,"\u9023\u7dda\u65b9\u5f0f:"),(0,l.kt)("p",null,"  nginx:\nimage: nginx:latest\ncontainer_name: nginx\nvolumes:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"  - ./nginx.conf:/etc/nginx/nginx.conf:ro\nports:\n  - '12345:80'\ndepends_on:\n  - wordpress\nlogging:\n  driver: gelf\n  options:\n    gelf-address: udp://127.0.0.1:12201\nhealthcheck:\n  test: ['CMD-SHELL', 'curl -f http://localhost || exit 1']\n  interval: 30s\n  timeout: 10s\n  retries: 3\nrestart: unless-stopped\n                    \n")),(0,l.kt)("p",null,"services:\nnginx:\nimage: nginx:latest\ncontainer_name: nginx\nvolumes:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"  - ./nginx.conf:/etc/nginx/nginx.conf:ro\nports:\n  - '12345:80'\ndepends_on:\n  - wordpress\nlogging:\n  driver: gelf\n  options:\n    gelf-address: udp://127.0.0.1:12201\nhealthcheck:\n  test: ['CMD-SHELL', 'curl -f http://localhost || exit 1']\n  interval: 30s\n  timeout: 10s\n  retries: 3\nrestart: unless-stopped\n")),(0,l.kt)("p",null,"  wordpress:\nimage: wordpress:latest\ncontainer_name: wordpress\nenvironment:\nWORDPRESS_DB_HOST: db\nWORDPRESS_DB_USER: exampleuser\nWORDPRESS_DB_PASSWORD: examplepass\nWORDPRESS_DB_NAME: exampledb\ndepends_on:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"  - db\nlogging:\n  driver: gelf\n  options:\n    gelf-address: udp://127.0.0.1:12201\nhealthcheck:\n  test:\n    ['CMD-SHELL', 'curl -f http://localhost/wp-admin/install.php || exit 1']\n  interval: 30s\n  timeout: 10s\n  retries: 3\nrestart: unless-stopped\n")),(0,l.kt)("p",null,"  db:\nimage: mysql:8\ncontainer_name: db\nenvironment:\nMYSQL_ROOT_PASSWORD: examplepass\nMYSQL_DATABASE: exampledb\nMYSQL_USER: exampleuser\nMYSQL_PASSWORD: examplepass\nvolumes:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"  - db_data:/var/lib/mysql\nlogging:\n  driver: gelf\n  options:\n    gelf-address: udp://127.0.0.1:12201\nhealthcheck:\n  test:\n    [\n      'CMD-SHELL',\n      'mysqladmin ping -h localhost -u root --password=examplepass || exit 1',\n    ]\n  interval: 30s\n  timeout: 10s\n  retries: 3\nrestart: unless-stopped\n")),(0,l.kt)("p",null,"volumes:\ndb_data:"),(0,l.kt)("h3",{id:"day-6-1"},"day 6"),(0,l.kt)("p",null,"source code \u6703\u6709\u4ec0\u9ebc\u8cc7\u5b89\u8b70\u984c\npackage - CVE\nhard code password - Vault CICD\u5f8c\u5728Server \u52a0\u5bc6\nsql injection\ntoken"),(0,l.kt)("p",null,"conotainer \u6703\u6709\u4ec0\u9ebc\u8cc7\u5b89\u98a8\u96aa\nport\npackage\nvolunm\nroot \u6b0a\u9650"),(0,l.kt)("p",null,"\u5bb9\u5668\u5316\u9694\u96e2"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u89e3 image \u6f0f\u6d1e\uff0c\u62c9image \u6642\u7528 checksum \u53bbpull , \u4e0d\u8981\u7528 \u7248\u672c\u865f\u53bb\u62c9\uff08\u907f\u514d\u62c9\u5230\u99ed\u5ba2\u7684\u7248\u672c\uff09")),(0,l.kt)("p",null,'"',(0,l.kt)("a",{parentName:"p",href:"https://github.com/srcmesh-workshop/docker-workshop"},"https://github.com/srcmesh-workshop/docker-workshop")),(0,l.kt)("p",null,"Prometheus: ",(0,l.kt)("a",{parentName:"p",href:"http://34.80.76.80:3000"},"http://34.80.76.80:3000"),"\nGraylog: ",(0,l.kt)("a",{parentName:"p",href:"http://34.80.76.80:9000"},"http://34.80.76.80:9000")),(0,l.kt)("p",null,'\u5e33\u5bc6\uff1aadmin / srcmesh-1234\n"\nsrcmesh-123456789'),(0,l.kt)("p",null,"image-ref : 'mysql:oracle'  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"                    vim .github \n                    \n        vim .github/workflows/image-scan.yaml\n")),(0,l.kt)("p",null,"ssh ",(0,l.kt)("a",{parentName:"p",href:"mailto:user-1@34.80.76.80"},"user-1@34.80.76.80"),"\nsrcmesh-123456789\nrunner-1"),(0,l.kt)("p",null,"nginx:latest\nwordpress:latest\nmysql:8"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"name: Test\nrun: |\nls\nshell: bash")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"name: Test\nrun: |\ndocker ps\nshell: bash"))),(0,l.kt)("h2",{id:"update-conntainername"},"update conntainername"),(0,l.kt)("p",null,"cd .cache/ans/single\ndocker compose up -d"))}u.isMDXComponent=!0},716:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/image-1-d1da21d6807c58756d34f084a5f48dac.png"}}]);